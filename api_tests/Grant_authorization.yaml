# Test generated by RoostGPT for test credwallet-integration-artillery-updated using AI Type Open AI and AI Model gpt-4


config:
  target: "{{ $processEnvironment.API_HOST }}"
  payload:
    path: "Grant_authorization.csv"
    fields:
      - "email"
    skipHeader: true
  plugins:
    expect: {}

scenarios:
  - name: "Grant authorization"
    flow:
      # Create account
      - post:
          url: "/accounts"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
            commit-hash: "{{ commitHash }}"
          json:
            email: "{{ email }}"
          expect:
            - statusCode: 201
            - hasHeader: 'api-version'
            - headerEquals: ['api-version', '1.0.0']
            - hasHeader: 'commit-hash'
          log: "Account created successfully"
          think: 1
      # Grant access
      - post:
          url: "/authorizations"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
            Token: "{{ apiKey }}"
          json:
            email: "{{ email }}"
          expect:
            - statusCode: 201
            - hasHeader: 'api-version'
            - headerEquals: ['api-version', '1.0.0']
            - hasHeader: 'location'
            - hasProperty: 'id'
            - hasProperty: 'name'
            - hasProperty: 'email'
            - hasProperty: 'createdAt'
            - hasProperty: 'updatedAt'
          log: "Access granted to the account"
          think: 1
      # Confirm access
      - get:
          url: "/authorizations"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
            Token: "{{ apiKey }}"
          expect:
            - statusCode: 200
            - hasHeader: 'api-version'
            - headerEquals: ['api-version', '1.0.0']
          log: "Access confirmed successfully"
          think: 1
