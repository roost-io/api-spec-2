# Test generated by RoostGPT for test credential-artillery-test using AI Type Open AI and AI Model gpt-4-1106-preview


# RoostTestHash=19003958c4

config:
  target: "{{ $processEnvironment.API_HOST }}"
  phases:
    - duration: 60
      arrivalRate: 1
  payload:
    path: "refundMessage_post_others.csv"
    fields:
      - "headerVersion"
      - "messageContext"
      - "sourceContext"
      - "timestamp"
      - "documentNumber"
      - "issuanceDate"
      - "refundIndicator"
      - "refundUID"
      - "refundedCoupons"
    skipHeader: true
  plugins:
    expect: {}

scenarios:
  - name: "Non-Success API Responses Test"
    flow:
      # Invalid Authentication
      - post:
          url: "/icd/s2s/exchange/refundMessage"
          headers:
            Authorization: "Bearer invalid_token"
          json:
            messageHeader: {}
          expect:
            - statusCode: 401
            - hasHeader: "www-authenticate"
          log: "Testing with invalid authentication should result in 401 Unauthorized."
        think: 1

      # Missing Required Fields
      - post:
          url: "/icd/s2s/exchange/refundMessage"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          json:
            messageHeader:
              headerVersion: "{{ headerVersion }}"
              timestamp: "{{ timestamp }}"
          expect:
            - statusCode: 400
            - hasProperty: "messageHeader"
            - notHasProperty: "sourceContext"
          log: "Testing with missing required fields should result in 400 Bad Request."
        think: 1

      # Invalid Payload Format
      - post:
          url: "/icd/s2s/exchange/refundMessage"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
            Content-Type: "application/xml"
          body: "<invalid>xml</invalid>"
          expect:
            - statusCode: 415
            - hasHeader: "content-type"
          log: "Testing with invalid payload format should result in 415 Unsupported Media Type."
        think: 1

      # Invalid URL
      - post:
          url: "/icd/s2s/exchange/invalidEndpoint"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          json:
            messageHeader: {}
          expect:
            - statusCode: 404
          log: "Testing with invalid URL should result in 404 Not Found."
        think: 1

      # Invalid Document Number Pattern
      - post:
          url: "/icd/s2s/exchange/refundMessage"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          json:
            messageHeader:
              headerVersion: "{{ headerVersion }}"
              messageContext: "{{ messageContext }}"
              sourceContext: "{{ sourceContext }}"
              timestamp: "{{ timestamp }}"
            payload:
              refundTransactions:
                documentNumber: "INVALID_DOC_NUMBER"
                issuanceDate: "{{ issuanceDate }}"
                refundIndicator: "{{ refundIndicator }}"
                refundUID: "{{ refundUID }}"
                refundedCoupons: "{{ refundedCoupons }}"
          expect:
            - statusCode: 422
            - hasProperty: "refundTransactions"
            - matchesRegexp: "documentNumber": "^[0][0][1][0-9]{10}$"
          log: "Testing with invalid document number pattern should result in 422 Unprocessable Entity."
        think: 1
